- 処理をモジュール化 (.py) して組み込む回を、Chapter 3の後に入れる予定

- モジュール化の説明

  - 関数のメリットをさらに進めるもの

    本 `p.54`「繰り返し使用する処理は、関数という形にまとめると、プログラムのコードをすっきりとまとめられます。」

  - 別のプログラムでも使いそうな関数を別のファイルに移す

    - プログラムのコードがよりすっきりする

    - 同じ処理が別のプログラムで必要になった時、同じ関数を作らずに済む

  - Colabで一つのセルに関数をまとめても、モジュールに比べ中途半端

    - セルの実行が何度も必要。例えば関数を修正した時や、ランタイムを再起動した時など

    - 他のノートブックの関数を使えない。例えばChapter 3で独自に作ったrecord関数など

- 次項の素材を事前にGitHubに上げる [TODO]

  - モジュールテスト用ノートブックのソース

  - モジュール `mymodule.py` のソース

- 実際の手順

  - ローカルファイル `mymodule.py` を作る（場所は任意）

  - 新しいノートブックを作る（名前は任意）

  - 新規セルにモジュール利用のコードを書いていく

    - 冒頭に `import mymodule` を行挿入

    - モジュール内関数の呼び出し箇所に `mymodule.` を挿入

    - Colabの左側でファイル（エクスプローラ的な画面）を開く

    - ローカルの`mymodule.py` をColabのファイルにドラッグ＆ドロップ

    - セルを実行、モジュールが正常に使えるのを確認

    - モジュールが読み込まれなければランタイム再起動して再試行（Colab特殊事情 1）

  - モジュールを修正したらどうなるか示す

    - ローカルの `mymodule.py` の関数を適当に修正して保存

    - 再びColabのファイルにドラッグ＆ドロップ

    - セルを実行しても修正が反映されないことがある（Colab特殊事情 2）

    - セルの `import mymodule` の後に以下を挿入

      ```Python
      import importlib
      importlib.reload(mymodule)
      ```

    - 再びセルを実行すると修正が反映されているはず

    - この後はローカル編集→Colabへドラッグ＆ドロップ→再実行で即反映されるはず

<br>

- 追加説明

  - 普通のPythonプログラムでは不要な特殊対応がColabで必要になる

  - モジュールだけでなく画像等も、ファイルからうまく読み込まれずランタイム再起動で直る場合がある

  - ノートブックを閉じる or ランタイムが切れるとドラッグ＆ドロップしたファイルが消える!!

  - じゃあどうしたら、という話 ★ は最後まで終わった後、要望があれば追加

<br>

- ドラッグ＆ドロップしたファイルの永続化 ★

    - 基本はGoogle Drive活用

      - 単純にマウントするとパスが深くなりファイル一覧が見にくい

      - 便利関数orモジュールが出来るか検討する [TODO]

        - ipynbでドライブマウント→WDにコピー→自動的にドライブアンマウント

      - それが出来たら use_module_for_all_chapters.ipynb も要改修

    - Google DriveのフォルダにGitHubのリポジトリを連携させるのは割愛必至

      - ターミナルのコマンド操作になってしまう

      - ColabとGitHubが直に連携できるのはあくまで単体の.ipynbファイル
